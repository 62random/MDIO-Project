/*********************************************
 * OPL 12.8.0.0 Model
 * Author: Asus
 * Creation Date: 01/12/2018 at 23:16:25
 *********************************************/
 
 
//Parâmetros sobre a dimensão do problema
int n = 7;
int a[i in 1..n] = i;


//Número de recursos b
int b = 8;

//Constante de retardamento do fogo por recurso delta
int delta = 8;

//Intervalo de tempo onde minimizar área ardida
float time = 1;

//Parâmetros sobre os custos dos arcos
int Cima [1..n][1..n] = ...;
int Direita [1..n][1..n] = ...;
int Baixo [1..n][1..n] = ...;
int Esquerda [1..n][1..n] = ...;
int Custos[1..n][1..n][1..n][1..n]; 							//Matriz contendo todos os arcos
float Probs[i in 1..n][j in 1..n] = (14 - i - j)/500;

//Código para preencher a matriz dos custos a partir das outras (extraídas da folha excel)
execute {
for(var x in a)
	for(var xx in a)
		for(var xxx in a)
			for(var xxxx in a)
				Custos[x][xx][xxx][xxxx] = 9999;

  for(var i in a) {
  	for(var j in a) {
		if(i > 1)  	
  	  	  	Custos[i][j][i - 1][j] = Cima[i][j];
  	  	if(i < n)  	
  	  	  	Custos[i][j][i + 1][j] = Baixo[i][j];
  	  	if(j > 1)  	
  	  	  	Custos[i][j][i][j - 1] = Esquerda[i][j];
  	  	if(j < n)  	
  	  	  	Custos[i][j][i][j + 1] = Direita[i][j];  	  	  
  	}  
  }}


//Variáveis de Decisão
 dvar float+ T[1..n][1..n][1..n][1..n];			//Tempo de um ij para um kl
 dvar boolean R[1..n][1..n];					//Recursos utilizados no nodo ij
 dvar boolean Arde[1..n][1..n][1..n][1..n];
 dvar float+ area;
 
 //Função Objetivo
 minimize sum(i in 1..n, j in 1..n, k in 1..n, l in 1..n)  Probs[i][j]*Arde[i][j][k][l];
  
 //Restrições
 subject to{
  	forall(i in 1..n, j in 1..n) T[i][j][i][j] == 0;
  	sum(i in 1..n, j in 1..n) R[i][j] <= b;
 	forall(i in 1..n, j in 1..n, k in 1..n, l in 1..n, m in 1..n, n in 1..n) T[i][j][k][l] <= T[i][j][m][n] + Custos[m][n][k][l] + R[m][n]*delta; 	
 	forall(i in 1..n, j in 1..n, k in 1..n, l in 1..n) Arde[i][j][k][l] >= (time - T[i][j][k][l])/time;
 	area == sum(i in 1..n, j in 1..n, k in 1..n, l in 1..n) Probs[i][j]*Arde[i][j][k][l];
 }